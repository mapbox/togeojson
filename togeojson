#!/usr/bin/env node

var tj = require('./'),
    argv = require('minimist')(process.argv.slice(2)),
    concat = require('concat-stream'),
    fs = require('fs'),
    xmldom = new (require('xmldom').DOMParser)();

if ((process.stdin.isTTY && !argv._[0])) {
    return help();
}

(argv._.length ? fs.createReadStream(argv._[0]) : process.stdin).pipe(concat(convert));

function convert(data) { process.stdout.write(
    JSON.stringify(tj.kml(xmldom.parseFromString(data.toString())), null, 4));
}

function help() {
    console.error('Usage: togeojson FILE\n');
}
